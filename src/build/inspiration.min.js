(function(){var q=q||{},C=C||{},w=w||{},r=r||{},D=D||{};q.Events=function(){return{bind:function(h,c){for(var f=h.split(" "),d=0,k=f.length;d<k;d++)h=f[d],this._callbacks||(this._callbacks={}),(this._callbacks[h]||(this._callbacks[h]=[])).push(c);return this},unbind:function(h,c){var f;if(!h)this._callbacks={};else if(f=this._callbacks)if(c){f=f[h];if(!f)return this;for(var d=0,k=f.length;d<k;d++)if(c===f[d]){f.splice(d,1);break}}else f[h]=[];return this},trigger:function(h){var c,f,d,k;if(!(f=this._callbacks))return this;
if(c=f[h])for(d=0,k=c.length;d<k;d++)c[d].apply(this,Array.prototype.slice.call(arguments,1));if(c=f.all)for(d=0,k=c.length;d<k;d++)c[d].apply(this,arguments);return this}}}();common=function(){var h=Array.prototype,c=Object.prototype.hasOwnProperty,f=h.slice,d=h.forEach,k=h.indexOf,b=h.map,e=h.filter,a=h.some,l=Function.prototype.bind,g=function(){},m={},s=function(a,b){return c.call(a,b)},n=function(a,b,c){if(null!=a)if(d&&a.forEach===d)a.forEach(b,c);else if(a.length===+a.length)for(var e=0,g=
a.length;e<g&&!(e in a&&b.call(c,a[e],e,a)===m);e++);else for(e in a)if(s(a,e)&&b.call(c,a[e],e,a)===m)break},z=function(a){return a},u=function(a,e,b){b||(b=z);for(var c=0,g=a.length;c<g;){var d=c+g>>1;b(a[d])<b(e)?c=d+1:g=d}return c},v=function(a,b,c){var g=[];if(null==a)return g;if(e&&a.filter===e)return a.filter(b,c);n(a,function(a,e,d){b.call(c,a,e,d)&&(g[g.length]=a)});return g};return{has:s,each:n,compact:function(a){return v(a,function(a){return!!a})},bind:function(a,b){var e,c;if(a.bind===
l&&l)return l.apply(a,f.call(arguments,1));if(!this.isFunction(a))throw new TypeError;c=f.call(arguments,2);return e=function(){if(!(this instanceof e))return a.apply(b,c.concat(f.call(arguments)));g.prototype=a.prototype;var d=new g,k=a.apply(d,c.concat(f.call(arguments)));return Object(k)===k?k:d}},bindAll:function(a){var b=f.call(arguments,1);0==b.length&&(b=this.functions(a));this.each(b,function(b){a[b]=this.bind(a[b],a)},this);return a},functions:function(a){var b=[],e;for(e in a)this.isFunction(a[e])&&
b.push(e);return b.sort()},extend:function(a){n(f.call(arguments,1),function(b){for(var e in b)a[e]=b[e]});return a},map:function(a,e,c){var g=[];if(null==a)return g;if(b&&a.map===b)return a.map(e,c);n(a,function(a,b,d){g[g.length]=e.call(c,a,b,d)});a.length===+a.length&&(g.length=a.length);return g},any:function(b,e,c){e||(e=this.identity);var g=!1;if(null==b)return g;if(a&&b.some===a)return b.some(e,c);n(b,function(a,b,d){if(g||(g=e.call(c,a,b,d)))return m});return!!g},indexOf:function(a,b,e){if(null==
a)return-1;var c;if(e)return e=u(a,b),a[e]===b?e:-1;if(k&&a.indexOf===k)return a.indexOf(b);e=0;for(c=a.length;e<c;e++)if(e in a&&a[e]===b)return e;return-1},sortedIndex:u,identity:z,after:function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}},debounce:function(a,b,e){var c;return function(){var g=this,d=arguments;e&&!c&&a.apply(g,d);clearTimeout(c);c=setTimeout(function(){c=null;e||a.apply(g,d)},b)}},clone:function(a){return this.isObject(a)?this.isArray(a)?a.slice():
this.extend({},a):a},isElement:function(a){return!(!a||1!=a.nodeType)},isArray:Array.isArray||function(a){return"[object Array]"==toString.call(a)},toArray:function(a){return a?this.isArray(a)||this.isArguments(a)?f.call(a):a.toArray&&this.isFunction(a.toArray)?a.toArray():this.values(a):[]},values:function(a){return this.map(a,this.identity)},once:function(a){var b=!1,e;return function(){if(b)return e;b=!0;return e=a.apply(this,arguments)}},isObject:function(a){return a===Object(a)},isNumber:function(a){return"[object Number]"==
toString.call(a)},isFunction:function(a){return"[object Function]"==toString.call(a)||"function"==typeof a},isUndefined:function(a){return void 0===a},isNull:function(a){return null===a},isRegExp:function(a){return"[object RegExp]"==toString.call(a)}}}();r.grid=function(h){var c=[888,813,738,663,588,513,438,363,288,213,138,63],f=[900,825,750,675,600,525,450,375,300,225,150,75,0];return{gutter:12,width:75,columns:12,getPosition:function(c){return Math.max(Math.min(c,this.columns),0)*this.width},getWidth:function(c){return this.getPosition(c)-
this.gutter},snapWidth:function(d,k){if(0===d)return{x:d,y:k};h.isUndefined(k)&&(k=0);for(var b=d,e=k,a=0,l=c.length;a<l;a++){var g=c[a];if(g<b){d=g;k=Math.floor(g*e/b);break}}return{x:d,y:k}},snapPosition:function(c,k){if(0===c)return{x:c,y:k};h.isUndefined(k)&&(k=0);for(var b=c,e=k,a=0,l=f.length;a<l;a++){var g=f[a];if(g<b){c=g;k=Math.floor(g*e/b);break}}return{x:c,y:k}}}}(common);(function(h,c,f,d,k,b,e){var a;function l(){B||c.cursor===c.total_pages&&0!==c.total_pages||(B=!0,c.cursor=Math.min(parseInt(c.cursor)+
1,c.total_pages),q.navigate("#/page/"+(c.total_pages-c.cursor)))}function g(a){e.each(a.records,function(a){switch(a.asset_type){case "image":var c=a.content.resized_images,g=c.stash,d=c.display,k=g&&e.isObject(g.dims),l=d&&e.isObject(d.dims),f=k?g.dims.w:l?d.dims.w:0,g=k?g.dims.h:l?d.dims.h:0;if(0===f||0===g)break;f=b.snapWidth(parseInt(f/2),parseInt(g/2));a=p.add({url:c.full,date:a.date,width:f.x,height:f.y,title:a.title,href:a.source});c=0;for(f=p.models.length;c<f;c++)g=p.models[c],a.id!==g.id&&
!p.areNeighbors(a,g)&&p.isNeighbors(a,g)&&p.makeNeighbors(a,g)}});a=0;for(var c=p.models.length;a<c;a++){var g=p.models[a];g.placed||(g.add({placed:!0}),v.place(g))}C();m();t.loader.hide();s.trigger("resize");B=!1}function m(){var b=n.height();a=0.9*b;b<=y?l():(b=x-w,v.update(b,y),t.updateDisplay(b,y))}var s=$(window),n=$(document),z=n.find("nav"),u=$("#content")[0],v=(new f).appendTo(u),t=(new d).appendTo(document.body),p=new k,q=new h,B=!1;q.route("page/:page","page",function(a){a=parseInt(a);var b=
c.total_pages-a;if(0>b||c.total_pages&&b>c.total_pages)b=Math.min(Math.max(b,0),c.total_pages),h.history.navigate("#/page/"+a,{silent:!0});c.cursor!==b&&(c.cursor=b);c.getAssetsForUser("jonobr1",g)?t.loader.show():B=!1});v.setGallery(p);t.setGallery(p).setStage(v);p.setStage(v);var x=a=0,r=0,y=s.height(),w=z.outerHeight(!0),E=z.offset(),A,C=e.once(function(){t.clock.setInitialTime(p.models[0].date)});s.resize(function(){y=s.height();E=z.offset();A=Math.max(w-x,t.gutter);var a=$(v.domElement).offset().top;
t.setOffset(E.left+32-r,A,x-a).setHeight(y-A-t.gutter)}).trigger("resize");var D=e.debounce(function(){v.update(x-w,y)},750);n.scroll(function(){var b=n.scrollTop(),c=n.scrollLeft(),e=$(v.domElement).offset().top;x<b&&b+y>a&&l();r=c;x=b;A=Math.max(w-x,t.gutter);t.setOffset(E.left+32-r,A,x-e).setHeight(y-A-t.gutter).updateViewport(x-w,y);D()});c.getAssetsForUser("jonobr1",function(a){c.total_pages=Math.floor(a.total_records/c.limit);h.history.start({root:"/inspiration/"})||(B=!0,q.navigate("#/page/"+
(c.total_pages-c.cursor)))},!0)})(q.Router=function(h,c,f){var d=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)};d.history=c;var k=/:\w+/g,b=/\*\w+/g,e=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(d.prototype,h,{initialize:function(){},route:function(a,b,e){c||(c=new History);f.isRegExp(a)||(a=this._routeToRegExp(a));e||(e=this[b]);c.route(a,f.bind(function(d){d=this._extractParameters(a,d);e&&e.apply(this,d);this.trigger.apply(this,["route:"+
b].concat(d));c.trigger("route",this,b,d)},this));return this},navigate:function(a,b){c.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)a.unshift([b,this.routes[b]]);b=0;for(var e=a.length;b<e;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(a){a=a.replace(e,"\\$&").replace(k,"([^/]+)").replace(b,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});return d}(q.Events,q.History=function(h,c){var f=
function(){this.handlers=[];c.bindAll(this,"checkUrl")},d=/^[#\/]/,k=/msie [\w.]+/;f.started=!1;c.extend(f.prototype,h,{interval:50,getHash:function(b){return(b=(b?b.location:window.location).href.match(/#(.*)$/))?b[1]:""},getFragment:function(b,e){if(null==b)if(this._hasPushState||e){b=window.location.pathname;var a=window.location.search;a&&(b+=a)}else b=this.getHash();b.indexOf(this.options.root)||(b=b.substr(this.options.root.length));return b.replace(d,"")},start:function(b){if(f.started)throw Error("history has already been started");
f.started=!0;this.options=c.extend({},{root:"/"},this.options,b);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);b=this.getFragment();var e=document.documentMode;if(e=k.exec(navigator.userAgent.toLowerCase())&&(!e||7>=e))this.iframe=$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b);this._hasPushState?$(window).bind("popstate",
this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=b;b=window.location;e=b.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!e)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&e&&b.hash&&(this.fragment=
this.getHash().replace(d,""),window.history.replaceState({},document.title,b.protocol+"//"+b.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);f.started=!1},route:function(b,e){this.handlers.unshift({route:b,callback:e})},checkUrl:function(b){b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe)));
if(b==this.fragment)return!1;this.iframe&&this.navigate(b);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(b){var e=this.fragment=this.getFragment(b);return c.any(this.handlers,function(a){if(a.route.test(e))return a.callback(e),!0})},navigate:function(b,e){if(!f.started)return!1;e&&!0!==e||(e={});var a=(b||"").replace(d,"");this.fragment!=a&&(this._hasPushState?(0!=a.indexOf(this.options.root)&&(a=this.options.root+a),this.fragment=a,window.history[e.replace?"replaceState":"pushState"]({},
document.title,a)):this._wantsHashChange?(this.fragment=a,this._updateHash(window.location,a,e.replace),this.iframe&&a!=this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,e.replace))):window.location.assign(this.options.root+b),e.silent||this.loadUrl(b))},_updateHash:function(b,e,a){a?b.replace(b.toString().replace(/(javascript:|#).*$/,"")+"#"+e):b.hash=e}});return new f}(q.Events,common),common),C.api=function(h){var c=
[],f={loaded:c,querying:!1,limit:10,cursor:0,total_records:0,total_pages:0,getAssetsForUser:function(d,k,b){this.querying=!0;d="https://gimmebar.com/api/v1/public/assets/"+d+("?skip="+this.cursor*this.limit)+("&limit="+this.limit);if(0<=h.indexOf(c,this.cursor))return!1;$.get("../php/get.php?q="+d,function(e){e=JSON.parse(e);var a=e.total_records;a&&f.total_records!==a&&(f.total_records=e.total_records,f.total_pages=Math.floor(f.total_records/f.limit));b||c.push(f.cursor);k(e);f.querying=!1});return!0}};
return f}(common),w.Stage=function(h,c){function f(d){var b=this.offset.x,e=Math.round((this.birthday-d.date)/10-this.offset.y);if(0!==d.id&&c.isArray(d.neighbors)){for(var a=0,f=d.neighbors.length;a<f;a++){var g=d.neighbors[a];if(!c.isUndefined(g.top)&&!c.isUndefined(g.left)){var m=g.left,s=m+(g.width||0),n=g.top,g=n+(g.height||0);b+(d.width||0)>=m&&b<=s&&e+(d.height||0)>=n&&e<=g&&(m=h.snapPosition(s+h.width).x,900>m+(d.width||0)&&m>b&&(b=m))}}a=0;for(f=d.neighbors.length;a<f;a++)g=d.neighbors[a],
c.isUndefined(g.top)||c.isUndefined(g.left)||(m=g.left,s=m+(g.width||0),n=g.top,g=n+(g.height||0),b+(d.width||0)>=m&&b<=s&&e+(d.height||0)>=n&&e<=g&&e<g&&(e=g+h.gutter))}e>this.range.max&&(this.range.max=e);if(e<this.range.min||0===this.range.min)this.range.min=e;return{left:b,top:e}}var d=function(){this.birthday=Math.round(Date.now()/1E3);this.$el=$('<div class="stage"/>');this.domElement=this.$el[0];this.offset={x:h.getPosition(2),y:0};this.range={min:0,max:0}};c.extend(d,{Id:"s-"});c.extend(d.prototype,
{appendTo:function(d){if(!c.isElement(d))return this;d.appendChild(this.domElement);c.extend(d.style,{overflow:"hidden"});return this},setGallery:function(c){this.gallery=c;return this},setMinimap:function(c){this.minimap=c;return this},place:function(c){var b=f.call(this,c),e=$("<div />").addClass("moment").attr("model",c.id).css({position:"absolute",background:"#d1d1d1"}).appendTo(this.domElement);c.href&&e.html('<a href="'+c.href+'"></a>');var a=function(){e.css({top:c.top+"px",left:c.left+"px",
width:c.width+"px",height:c.height+"px"})};c.bind("change",a).add(b);a();this.updateDisplay();return e[0]},update:function(d,b){var e=d+b;c.each(this.gallery.models,function(a){var b=a.top-this.range.min,c=b+a.height,f=this.$el.find("[model="+a.id+"]");0<f.length&&(b>e||c<d?(f.removeClass("visible"),this.gallery.hideImage(a,f[0])):(f.addClass("visible"),this.gallery.getImageForModel(a,f[0])))},this)},updateDisplay:function(){c.extend(this.domElement.style,{marginTop:-this.range.min+"px",height:this.range.max+
"px"})}});return d}(r.grid,common),w.Minimap=function(h,c,f,d){var k=$(document);$(window);var b=function(){this.width=c.getWidth(1);this.gutter=c.gutter;this.$el=$('<div class="minimap" />');this.domElement=this.$el[0];this.canvas=document.createElement("canvas");this.ctx=this.canvas.getContext("2d");this.loader=h;this.viewport=$('<div class="viewport" />')[0];this.clock=new f(20,20);this.domElement.appendChild(this.viewport);this.domElement.appendChild(this.canvas);this.domElement.appendChild(this.loader.domElement);
this.domElement.appendChild(this.clock.domElement);var b=d.bind(function(b){k.bind("mousemove",a).bind("mouseup",l)},this),a=d.bind(function(a){a.preventDefault();a.stopPropagation();var b=this.$el.offset();Math.max(Math.min(a.pageX-b.left,this.width),0);a=Math.max(Math.min(a.pageY-b.top,this.height),0);a=this.fromWorldY(a);k.scrollTop(a)},this),l=d.bind(function(b){k.unbind("mousemove",a).unbind("mouseup",l)},this);$(this.domElement).bind("mousedown",b).bind("mouseup",function(b){a(b);l()})};d.extend(b.prototype,
{appendTo:function(b){if(!d.isElement(b))return this;b.appendChild(this.domElement);return this},setStage:function(b){this.stage=b;return this},setGallery:function(b){this.gallery=b;return this},setOffset:function(b,a,c){d.extend(this.domElement.style,{left:b+"px",top:a+"px"});this.clock.setTimeByPosition(c);return this},setHeight:function(b){if(b===this.height)return this;this.height=b;d.extend(this.domElement.style,{width:this.width+"px",height:this.height+"px"});this.canvas.width=this.width;this.canvas.height=
this.height;this.updateDisplay();return this},toWorldX:function(b){return Math.ceil(b/(this.stage.width/this.width))},toWorldY:function(b){return Math.ceil(b/(this.stage.height/this.height))},fromWorldX:function(b){return Math.ceil(this.stage.width/this.width*b)},fromWorldY:function(b){return Math.ceil(this.stage.height/this.height*b)},update:function(){var b=$(this.stage.domElement);this.stage.width=b.width();this.stage.height=b.height()-this.stage.range.min;return this},updateDisplay:function(b,
a){this.update();this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.ctx.fillStyle="#fff";var c=this.stage.offset.x/2;d.each(this.gallery.models,function(a){var b=this.toWorldX(a.left-c),d=this.toWorldY(a.top-this.stage.range.min),e=this.toWorldX(a.width);a=this.toWorldY(a.height)+6;this.ctx.fillRect(b,d,e,a)},this);this.updateViewport(b,a);return this},updateViewport:function(b,a){d.extend(this.viewport.style,{top:this.toWorldY(b)+"px",height:this.toWorldY(a)+"px"});return this}});
return b}(r.loader=function(h){var c=!1,f=document.createElement("div"),d=$(f).css("display","block").addClass("loader"),k=document.createElement("img");k.src="../images/loader.gif";f.appendChild(k);return{domElement:f,isVisible:function(){return!c},show:function(b){if(!c)return this;d.fadeIn(150,function(){c=!1;(h.isFunction(b)?b:h.identity)()})},hide:function(b){if(c)return this;d.fadeOut(150,function(){c=!0;(h.isFunction(b)?b:h.identity)()})}}}(common),r.grid,w.Clock=function(h,c,f){function d(c){var d,
f;f=Math.sin(c/b*e);c=Math.floor(k(a.day.r,a.night.r,f));d=Math.floor(k(a.day.g,a.night.g,f));f=Math.floor(k(a.day.b,a.night.b,f));return"rgb("+c+","+d+","+f+")"}function k(a,b,c){return(b-a)*c+a}var b=86400,e=2*Math.PI,a={day:{r:252,g:192,b:151},night:{r:201,g:192,b:255}},l=function(a,b){var d=this;this.width=a||20;this.height=b||20;var e={width:this.width+1,height:this.height+1};this.domElement=document.createElement("div");this.container=h.createElement("svg");this.circle=h.createElement("circle");
this.label=$('<p class="day" />');this.container.appendChild(this.circle);this.domElement.appendChild(this.container);this.domElement.appendChild(this.label[0]);this.__fadeLabelOut=c.debounce(function(){d.label.fadeOut()},2500);h.addClass(this.domElement,"clock").setAttributes(this.container,e).setAttributes(this.circle,{fill:"#fff",cx:e.width/2,cy:e.height/2,r:this.width/2})};c.extend(l.prototype,{changeDate:function(a){a=f(a,"mm/dd/yy").replace(/\//g,"&middot;");this.label.html(a)},getCurrentTime:function(){return this.time-
(10*this.offset||0)},setInitialTime:function(a){this.time=a;this.day=0;this.updateDisplay();return this},setTimeByPosition:function(a){this.offset=a;this.updateDisplay();return this},updateDisplay:function(){if(c.isUndefined(this.time))return this;var a=this.getCurrentTime(),b=new Date(1E3*a);h.setAttributes(this.circle,{fill:d(a)});a=b.toDateString();a!==this.day&&(this.day=a,this.changeDate(b));b=this.label;"none"==b.css("display")&&b.stop().fadeIn(150);this.__fadeLabelOut();return this}});return l}(D.utils=
function(h){return{svgns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",createElement:function(c,f){var d=document.createElementNS(this.svgns,c);f&&this.setAttributes(d,f);return d},createImage:function(c){var f=this.createElement("image");f.setAttributeNS(this.xlinkns,"href",c);return f},createUse:function(c){var f=this.createElement("use");f.setAttributeNS(this.xlinkns,"href","#"+c);return f},setClass:function(c,f){c.getAttribute("class")!==f&&c.setAttribute("class",f)},addClass:function(c,
f){var d=c.getAttribute("class");null===d?c.setAttribute("class",f):d!==f&&(d=d.split(/ +/),-1==d.indexOf(f)&&(d.push(f),c.setAttribute("class",d.join(" "))));return this},bezierString:function(c,f,d,k,b,e,a,l){return"M"+c.toFixed(10)+","+f.toFixed(10)+" C"+d.toFixed(10)+","+k.toFixed(10)+" "+b.toFixed(10)+","+e.toFixed(10)+" "+a.toFixed(10)+" "+l.toFixed(10)},removeClass:function(c,f){var d=c.getAttribute("class");if(null!==d){if(d===f)c.setAttribute("class","");else{var d=d.split(/ +/),k=d.indexOf(f);
-1!=k&&(d.splice(k,1),c.setAttribute("class",d.join(" ")))}return this}},hasClass:function(c,f){var d=c.getAttribute("class");return RegExp(f).test(d)},setAttributes:function(c,f){h.each(f,function(d,f){c.setAttribute(f,d)});h.extend(c,f);return this},setTransform:function(){arguments[0].setAttribute("transform",this.transformString.apply(this,h.toArray(arguments).splice(1)))},transformString:function(c){function f(c,b){return c+"("+b.join(" ")+")"}if(h.isArray(c)){var d=[];h.each(h.toArray(arguments),
function(c){d.push(f(c[0],c.slice(1)))});return d.join(" ")}return f(arguments[0],h.toArray(arguments).slice(1))}}}(common),common,dateFormat=function(){var h=function(){var c=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,f=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,d=/[^-+\dA-Z]/g,k=function(b,c){b=String(b);for(c=c||2;b.length<c;)b="0"+b;return b};return function(b,e,a){var l=h;1!=arguments.length||
"[object String]"!=Object.prototype.toString.call(b)||/\d/.test(b)||(e=b,b=void 0);b=b?new Date(b):new Date;if(isNaN(b))throw SyntaxError("invalid date");e=String(l.masks[e]||e||l.masks["default"]);"UTC:"==e.slice(0,4)&&(e=e.slice(4),a=!0);var g=a?"getUTC":"get",m=b[g+"Date"](),s=b[g+"Day"](),n=b[g+"Month"](),q=b[g+"FullYear"](),u=b[g+"Hours"](),v=b[g+"Minutes"](),t=b[g+"Seconds"](),g=b[g+"Milliseconds"](),p=a?0:b.getTimezoneOffset(),r={d:m,dd:k(m),ddd:l.i18n.dayNames[s],dddd:l.i18n.dayNames[s+7],
m:n+1,mm:k(n+1),mmm:l.i18n.monthNames[n],mmmm:l.i18n.monthNames[n+12],yy:String(q).slice(2),yyyy:q,h:u%12||12,hh:k(u%12||12),H:u,HH:k(u),M:v,MM:k(v),s:t,ss:k(t),l:k(g,3),L:k(99<g?Math.round(g/10):g),t:12>u?"a":"p",tt:12>u?"am":"pm",T:12>u?"A":"P",TT:12>u?"AM":"PM",Z:a?"UTC":(String(b).match(f)||[""]).pop().replace(d,""),o:(0<p?"-":"+")+k(100*Math.floor(Math.abs(p)/60)+Math.abs(p)%60,4),S:["th","st","nd","rd"][3<m%10?0:(10!=m%100-m%10)*m%10]};return e.replace(c,function(a){return a in r?r[a]:a.slice(1,
a.length-1)})}}();h.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};h.i18n={dayNames:"Sun Mon Tue Wed Thu Fri Sat Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),monthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec January February March April May June July August September October November December".split(" ")};
return h}()),common),w.Gallery=function(h,c,f,d){function k(a,b){var d=$(b||"<img />").attr("alt",a.title).css({display:"none"}).bind("load",function(){if(0===a.width){var b=Math.min(d.width(),c.getWidth(11)),e=d.height(),b=c.snapWidth(b,e);d.width(b.x).height(b.y);a.setWidth(b.x);a.setHeight(b.y)}f.add(d,d.parent(),!0);d.fadeIn()}),e=d[0];0!==a.width&&(e.width=a.width);0!==a.height&&(e.height=a.height);e.src=a.url;return e}var b=$(document),e=0,a=function(){this.models=[];this.images=[]};d.extend(a,
{MaxImages:50,Threshold:3600});d.extend(a.prototype,{add:function(a){a.id=e;e++;a=new h(a);this.models.push(a);return a},areNeighbors:function(a,b){return a.neighbors&&0<a.neighbors.length&&0<=d.indexOf(a.neighbors,b)},isNeighbors:function(b,c){return Math.abs(b.date-c.date)<a.Threshold},makeNeighbors:function(a,b){d.isArray(a.neighbors)||a.add({neighbors:[]});d.isArray(b.neighbors)||b.add({neighbors:[]});a.neighbors.push(b);b.neighbors.push(a)},hideImage:function(a,b){var c=this.getImageById(a.id);
d.isElement(c)&&$(c).fadeOut();return this},setStage:function(a){this.stage=a;return this},getImageForModel:function(a,b){var c=this.makeImage(a);b.children[0].appendChild(c);return this},makeImage:function(b){var c=this.images.length,e=this.getImageById(b.id);if(d.isElement(e))return $(e).fadeIn()[0];if(c<a.MaxImages)return k(b);e=this.getImageOffScreen();return k(b,e)},getImageOffScreen:function(){for(var a,b=0,c=this.images.length;b<c;b++){var d=this.images[b],e=$(d).parent();0<e.length&&!e.hasClass("visible")&&
(a=d)}return a},getImageById:function(a){return b.find("[model="+a+"] img")[0]}});return a}(q.Model=function(h,c){function f(d,b,e){this[b]=c.isObject(d)?c.clone(d):d;this["get"+e]=function(){return this[b]};this["set"+e]=function(a,c){if(a===this[b])return this;this[b]=a;c||this.trigger("change",b,a);return this}}var d=function(d){c.isObject(d)&&this.add(d)};c.extend(d.prototype,h,{add:function(d,b){c.each(d,function(d,a){var h;h=a.charAt(0).toUpperCase()+a.substring(1).toLowerCase();if(c.isUndefined(this[a]))f.call(this,
d,a,h);else this["set"+h](d,b)},this);return this}});return d}(q.Events,common),r.grid,r.label=function(){return{add:function(h,c,f){var d=h.attr("alt"),k=!!f;if(d&&!(0>=d.length||h.hasClass("has-label"))){f=marked(d);var b=$('<div class="label image" />').html(f).appendTo(c||document.body);c=$(c||document.body);f=function(){var a,d,e;k?a={left:0,top:0}:(d=c.offset().top,a=h.offset(),e=(h.outerWidth()-h.width())/2,d=(h.outerHeight()-h.height())/2-d,a={left:a.left+e+"px",top:a.top+d+"px"});b.css(a).fadeIn(150)};
var d=function(a){a=$(a.relatedTarget);a.hasClass("image")||a.hasClass("label")||b.fadeOut(150)},e=k?c:h;h.addClass("has-label");e.hover(f,d).bind("touchstart",f).bind("touchend",d);return b}}}}(),common),r.grid,common)})();